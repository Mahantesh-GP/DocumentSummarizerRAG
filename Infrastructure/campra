
private static HashSet<string> processedRequests = new();
string requestId = req.Headers["x-ms-request-id"];

    if (string.IsNullOrWhiteSpace(requestId))
        return new BadRequestObjectResult("Missing request ID");

    lock (processedRequests)
    {
        if (processedRequests.Contains(requestId))
            return new ConflictObjectResult("Duplicate request");

        processedRequests.Add(requestId);
    }

    // Your logic here
    await Task.Delay(500); // simulate work
