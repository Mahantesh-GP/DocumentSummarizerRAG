using System;
using System.Collections.Generic;
using Azure;
using Azure.Search.Documents.Indexes;
using Azure.Search.Documents.Indexes.Models;

class Program
{
    static async Task Main(string[] args)
    {
        string searchServiceEndpoint = "https://<your-search-service>.search.windows.net";
        string apiKey = "<your-admin-key>";

        var credential = new AzureKeyCredential(apiKey);
        var indexClient = new SearchIndexClient(new Uri(searchServiceEndpoint), credential);

        // Step 1: Create Synonym Map
        var synonymMap = new SynonymMap("address-synonyms", SynonymMapFormat.Solr, @"
            st, street
            ave, avenue
            rd, road
            blvd, boulevard
            ct, court
        ");

        await indexClient.CreateOrUpdateSynonymMapAsync(synonymMap);

        // Step 2: Define Search Fields
        var fields = new List<SearchField>
        {
            new SimpleField("id", SearchFieldDataType.String) { IsKey = true, IsFilterable = true },
            new SearchableField("propertyAddress")
            {
                IsSearchable = true,
                IsFilterable = true,
                IsSortable = true,
                SynonymMapNames = { "address-synonyms" }
            },
            new SearchableField("documentTitle") { IsSearchable = true, IsSortable = true },
            new SearchableField("content") { IsSearchable = true }
        };

        // Step 3: Create Search Index
        var index = new SearchIndex("documents-index")
        {
            Fields = fields
        };

        await indexClient.CreateOrUpdateIndexAsync(index);

        Console.WriteLine("Synonym map and index created successfully.");
    }
}
