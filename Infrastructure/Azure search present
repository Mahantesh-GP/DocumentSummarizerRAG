using Azure.AI.OpenAI;
using Azure;
using System.Text.Json;

// Define the tool (function)
var functions = new List<ChatCompletionsFunctionToolDefinition>
{
    new ChatCompletionsFunctionToolDefinition
    {
        Name = "search_documents",
        Description = "Search documents in Azure Cognitive Search",
        Parameters = BinaryData.FromObjectAsJson(new
        {
            type = "object",
            properties = new
            {
                query = new { type = "string", description = "Query to search for" }
            },
            required = new[] { "query" }
        })
    }
};

// Prepare chat completion options
var options = new ChatCompletionsOptions
{
    DeploymentName = "gpt-4-mini",
    Messages =
    {
        new ChatRequestSystemMessage("You are a document assistant"),
        new ChatRequestUserMessage("search for 3 cumings court documents")
    },
    Tools = { functions[0] }, // use the function(s) here
    ToolChoice = ToolChoice.AutoInvoke
};

// Send request to OpenAI
var response = await _openAIClient.GetChatCompletionsAsync(options);

// Handle response...
